<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="seed.project.cart.model.mapper.CartMapper">

	<!-- 장바구니 리스트 -->
	<select id="cartList">
		SELECT CART_NO, SEED_NO, COUNT, SEED_IMG_PATH, SEED_NAME, SEED_PRICE
		FROM "CART"
		JOIN "SEED" USING(SEED_NO)
		WHERE MEMBER_NO = #{memberNo}
	</select>
	
	<!-- 장바구니 추가 -->
	<insert id="addCart">
		INSERT INTO "CART"
		VALUES(SEQ_CART_NO.NEXTVAL, #{memberNo}, #{seedNo}, DEFAULT)
	</insert>
	
	<!-- 장바구니에 같은 씨앗이 존재한지 확인 -->
	<select id="checkSeed">
		SELECT COUNT(*) FROM "CART"
		WHERE MEMBER_NO = #{memberNo}
		AND SEED_NO = #{seedNo}
	</select>
	
	<!-- 씨앗 개수 1 증가 -->
	<update id="seedUp">
		UPDATE "CART" SET
		COUNT = (SELECT COUNT FROM "CART"
				WHERE MEMBER_NO = #{memberNo}
				AND SEED_NO = #{seedNo}) + 1
		WHERE MEMBER_NO = #{memberNo}
		AND SEED_NO = #{seedNo}

	</update>

</mapper>